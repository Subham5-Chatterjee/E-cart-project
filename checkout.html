<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Billing Details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="css/header-footer.css" type="text/css" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <link rel="stylesheet" href="css/checkout.css" type="text/css" />
    <link rel="stylesheet" href="css/responsive.css" type="text/css" />
  </head>

  <body>
    <div class="top-bar">
      <div class="container">
        <p>
          Summer Sale For All Product And Free Express Delivery - OFF 50%!
          <a href="#" class="text-white fw-bold ms-1">ShopNow</a>
        </p>
      </div>
    </div>

    <nav class="navbar navbar-expand-lg bg-white shadow-sm">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
          <img src="images/logo.png" alt="Logo" class="img-fluid site-logo" />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarContent"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="product-listing.html">Shop</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link" href="#sale_live">Product</a>
              <!-- <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Product 1</a></li>
                            <li><a class="dropdown-item" href="#">Product 2</a></li>
                        </ul> -->
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Blog</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Contact</a>
            </li>
          </ul>
        </div>
        <ul class="navbar-nav align-items-center header-icon">
          <button class="btn search-button" type="submit">
            <i class="fa-solid fa-magnifying-glass"></i>
          </button>
          <button class="icon-btn position-relative">
            <a href="wishlist.html"> <i class="fa-regular fa-heart"></i></a>
            <span
              class="badge bg-primary rounded-pill cart-badge"
              id="wishCount"
              >0</span
            >
          </button>
          <button class="icon-btn position-relative">
            <a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a>
            <span
              class="badge bg-primary rounded-pill cart-badge"
              id="cartCount"
              >0</span
            >
          </button>
          <button class="icon-btn user-btn">
            <i class="fa-regular fa-user"></i>
          </button>
        </ul>
      </div>
    </nav>

    <section class="billing_details">
      <form id="checkoutForm">
        <div class="container my-md-5">
          <div class="row">
            <!-- Billing Details -->
            <div class="col-lg-7">
              <div class="form-section billing_details_info">
                <h4>Billing details</h4>

                <div class="mb-3">
                  <label for="fullName" class="form-label"
                    >Full Name <sup>*</sup></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="fullName"
                    placeholder="Enter Your Name"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label for="address" class="form-label"
                    >Street address <sup>*</sup></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="address"
                    placeholder="House number and street name"
                    required
                  />
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="city" class="form-label"
                      >Town / City <sup>*</sup></label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="city"
                      placeholder="Enter Your City"
                      required
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="country" class="form-label"
                      >Country <sup>*</sup></label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="country"
                      placeholder="Enter Your Country"
                      required
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="phone" class="form-label"
                      >Phone <sup>*</sup></label
                    >
                    <input
                      type="tel"
                      class="form-control"
                      id="phone"
                      placeholder="Enter Your Phone"
                      required
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="zip" class="form-label"
                      >Zip Code <sup>*</sup></label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="zipcode"
                      placeholder="Enter Your Zip"
                      required
                    />
                  </div>
                </div>
                <div class="mb-3">
                  <label for="email" class="form-label"
                    >Email address <sup>*</sup></label
                  >
                  <input
                    type="email"
                    class="form-control"
                    id="email"
                    placeholder="Enter Your Email"
                    required
                  />
                </div>
              </div>
              <div class="payment_details_info mt-4">
                <div class="form-check mb-3">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="paymentMethod"
                    id="cod"
                    checked
                  />
                  <label class="form-check-label ps-3" for="cod">
                    Cash on delivery. Please contact us if you require
                    assistance or wish to make alternate arrangements.
                  </label>
                </div>
                <div class="form-check mb-3">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="paymentMethod"
                    id="card"
                    disabled
                  />
                  <label class="form-check-label ps-3" for="card">
                    Card Payment. Please contact us if you require assistance or
                    wish to make alternate arrangements.
                  </label>
                </div>
              </div>
            </div>

            <!-- Order Summary -->
            <div class="col-lg-5">
              <div class="order-summary my-4 my-lg-0">
                <h5>Order Summary</h5>
                <!-- <div class="d-flex justify-content-between p-details">
                            <span id="pro-name">sdewerwerwerwer</span>
                            <span class="" id="pro-quantity"> X 1</span>
                            <span class="product_price" id="pro-price">$1399</span>
                        </div> -->
                <div id="checkoutContainer"></div>

                <div class="d-flex justify-content-between sub-details">
                  <span>Subtotal</span>
                  <span
                    >$<span class="subtotal_price" id="subtotal"></span
                  ></span>
                </div>
                <div class="d-flex justify-content-between shipping_info">
                  <span>Shipping</span>
                  <span
                    >$<span class="shipping_price" id="shipping"></span
                  ></span>
                </div>
                <hr />
                <div class="d-flex justify-content-between total_value">
                  <strong>Total</strong>
                  <span
                    ><strong>$</strong
                    ><strong class="total-price" id="total"></strong
                  ></span>
                </div>
                <p class="mt-3 policy_info">
                  Your personal data will be used to support your experience
                  throughout this website, to manage access to your account, and
                  for other purposes described in our
                  <strong><a href="#">privacy policy</a></strong
                  >.
                </p>
                <button
                  type="submit"
                  class="btn btn-primary w-100 mt-3 checkout_order_btn"
                >
                  Place order
                </button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </section>

    <footer class="footer text-white pt-5">
      <div class="newsletter_part">
        <div class="container">
          <!-- Newsletter -->
          <div class="row text-center text-md-start align-items-center">
            <div class="col-md-6 mb-3 mb-md-0">
              <h4>
                Subscribe our Newsletter and get <strong>30%</strong> discount
                for your <strong>First</strong> order
              </h4>
            </div>
            <div class="col-md-6">
              <form
                class="d-flex flex-column flex-sm-row gap-2 position-relative"
              >
                <input
                  type="email"
                  class="form-control"
                  placeholder="Enter Your email"
                  required
                />
                <button
                  type="submit"
                  class="submit-btn input__field_form_button"
                >
                  Submit Now
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="news_hr"></div>
      </div>

      <!-- Footer Links -->
      <div class="footer_part">
        <div class="container">
          <div class="row text-start">
            <div class="col-md-6">
              <div class="row">
                <div class="col-5 col-md-5">
                  <div class="footer-logo">
                    <img
                      src="images/logo-white.png"
                      alt="Ecart logo"
                      class="img-fluid"
                    />
                  </div>
                  <p class="mt-2 footer-text">
                    Stay connected for updates, exclusive offers, and more:
                  </p>
                  <div class="social-icons mt-3">
                    <a href="#"
                      ><img src="images/ins.png" alt="" class="img-fluid"
                    /></a>
                    <a href="#"
                      ><img src="images/facebook'.png" alt="" class="img-fluid"
                    /></a>
                    <a href="#"
                      ><img src="images/tictok.png" alt="" class="img-fluid"
                    /></a>
                  </div>
                </div>
                <div class="col-7 col-md-7">
                  <h6 class="footer_head">About Ecart</h6>
                  <p class="footer-text">
                    Ecart is your trusted online destination for quality
                    products at unbeatable prices. From mobile to home
                    essentials & gadgets, we bring you a seamless shopping
                    experience backed by fast delivery and top-notch customer
                    support.
                  </p>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="row mt-4 mt-md-0">
                <div class="col-4 col-md-4">
                  <h6 class="footer_head">Legal</h6>
                  <ul class="list-unstyled">
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms & Conditions</a></li>
                    <li><a href="#">Contact Us</a></li>
                  </ul>
                </div>

                <div class="col-4 col-md-4">
                  <h6 class="footer_head">Service</h6>
                  <ul class="list-unstyled">
                    <li><a href="#">Help Center</a></li>
                    <li><a href="#">Returns & Refunds</a></li>
                    <li><a href="#">Shipping Info</a></li>
                  </ul>
                </div>

                <div class="col-4 col-md-4">
                  <h6 class="footer_head">Quick Links</h6>
                  <ul class="list-unstyled">
                    <li><a href="#">New Arrivals</a></li>
                    <li><a href="#">Best Sellers</a></li>
                    <li><a href="#">Today's Deals</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="footer-bottom text-center mt-4">
          <div class="container">
            <div class="row">
              <div class="col-12 text-center copyText">
                &copy; 2025 Ecart. All Rights Reserved.
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        //checkout
        const cartData = JSON.parse(localStorage.getItem("cart")) || [];

        const isOnCartPage = window.location.pathname.includes("cart.html");

        if (cartData.length === 0 && !isOnCartPage) {
          // Redirect if cart is empty
          window.location.href = "cart.html";
        } else {
          const checkoutContainer =
            document.getElementById("checkoutContainer");

          // console.log(cartData);

          const subtotalEl = document.getElementById("subtotal");
          const totalEl = document.getElementById("total");
          const shippingEl = document.getElementById("shipping");

          let subtotal = 0;
          const shipping = 5.0;

          // console.log('subtotalEl', subtotalEl)
          // console.log('totalEl', totalEl)
          // console.log('shippingEl', shippingEl)

          cartData.forEach((item) => {
            const totalPrice = item.sale_price * item.quantity;
            subtotal += totalPrice;

            const productRow = document.createElement("div");
            productRow.className = "checkCartrow";
            productRow.innerHTML = `
            <div class="d-flex justify-content-between p-details">
                            <p class="">${item.name}</p><span class=""> X ${
              item.quantity
            }</span>
                            <span class="product_price">$${
                              item.sale_price * item.quantity
                            }</span>
                        </div>
      `;
            checkoutContainer.insertBefore(productRow, null);
            console.log(productRow);
          });

          subtotalEl.textContent = subtotal.toFixed(2);
          shippingEl.textContent = shipping.toFixed(2);
          totalEl.textContent = (subtotal + shipping).toFixed(2);
        }

        document
          .getElementById("checkoutForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();

            // Get form values
            const formData = {
              email: document.getElementById("email").value,
              phone: document.getElementById("phone").value,
              city: document.getElementById("city").value,
              fullname: document.getElementById("fullName").value,
              address: document.getElementById("address").value,
              country: document.getElementById("country").value,
              // region: document.getElementById("state").value,
              postalCode: document.getElementById("zipcode").value,
              cod: document.getElementById("cod").checked,
            };

            const fullName = `${formData.fullname}`;
            const fullAddress = `${formData.address}, ${formData.city}, ${formData.region} - ${formData.postalCode}, ${formData.country}`;
            const phoneOrEmail = formData.emailPhone;

            const cartData = JSON.parse(localStorage.getItem("cart")) || [];
            let subtotal = 0;
            const shipping = 0; // Flat rate; change if dynamic

            const products = cartData.map((item) => {
              const totalPrice = item?.sale_price * item.quantity;
              subtotal += totalPrice;

              return {
                name: item.title,
                color: item.color,
                quantity: item.quantity,
                pricePerUnit: item?.sale_price,
                totalPrice: totalPrice,
              };
            });

            const finalTotal = subtotal + shipping;

            const orderSummary = {
              customerName: fullName,
              contact: phoneOrEmail,
              address: fullAddress,
              products: products,
              subtotal: subtotal.toFixed(2),
              shipping: shipping.toFixed(2),
              total: finalTotal.toFixed(2),
              paymentMethod: formData.cod ? "Cash On Delivery" : "Prepaid",
            };

            // Save everything together
            localStorage.setItem(
              "orderDetails",
              JSON.stringify({
                formData,
                orderSummary,
              })
            );

            // Redirect to thank you page
            window.location.href = "/thank-you.html";
          });
      });
    </script>
  </body>
</html>
